!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).Decimal=n()}(this,function(){"use strict";var t=function(t,n,e){if(null==t||null==n)return t;var o=String(t),r="number"==typeof n?n:parseInt(n,10);if(isNaN(r)||!isFinite(r))return o;var i=o.length;if(i>=r)return o;var s=null==e?"":String(e);""===s&&(s=" ");for(var a=r-i;s.length<a;)s+=s;return o+(s.length>a?s.substr(0,a):s)},n=function(){for(var t=[],n=-323;n<=308;n++)t.push(Number("1e"+n));return function(n){return t[n+323]}}();return function(){function e(t){this.mantissa=NaN,this.exponent=NaN,t instanceof e?this.fromDecimal(t):"number"==typeof t?this.fromNumber(t):"string"==typeof t?this.fromString(t):(this.mantissa=0,this.exponent=0)}return Object.defineProperty(e.prototype,"m",{get:function(){return this.mantissa},set:function(t){this.mantissa=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"e",{get:function(){return this.exponent},set:function(t){this.exponent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"s",{get:function(){return this.sign()},set:function(t){if(0===t)return this.e=0,void(this.m=0);this.sgn()!==t&&(this.m=-this.m)},enumerable:!0,configurable:!0}),e.fromMantissaExponent=function(t,n){return(new e).fromMantissaExponent(t,n)},e.fromMantissaExponent_noNormalize=function(t,n){return(new e).fromMantissaExponent_noNormalize(t,n)},e.fromDecimal=function(t){return(new e).fromDecimal(t)},e.fromNumber=function(t){return(new e).fromNumber(t)},e.fromString=function(t){return(new e).fromString(t)},e.fromValue=function(t){return(new e).fromValue(t)},e.fromValue_noAlloc=function(t){return t instanceof e?t:new e(t)},e.abs=function(t){return e.fromValue_noAlloc(t).abs()},e.neg=function(t){return e.fromValue_noAlloc(t).neg()},e.negate=function(t){return e.fromValue_noAlloc(t).neg()},e.negated=function(t){return e.fromValue_noAlloc(t).neg()},e.sign=function(t){return e.fromValue_noAlloc(t).sign()},e.sgn=function(t){return e.fromValue_noAlloc(t).sign()},e.round=function(t){return e.fromValue_noAlloc(t).round()},e.floor=function(t){return e.fromValue_noAlloc(t).floor()},e.ceil=function(t){return e.fromValue_noAlloc(t).ceil()},e.trunc=function(t){return e.fromValue_noAlloc(t).trunc()},e.add=function(t,n){return e.fromValue_noAlloc(t).add(n)},e.plus=function(t,n){return e.fromValue_noAlloc(t).add(n)},e.sub=function(t,n){return e.fromValue_noAlloc(t).sub(n)},e.subtract=function(t,n){return e.fromValue_noAlloc(t).sub(n)},e.minus=function(t,n){return e.fromValue_noAlloc(t).sub(n)},e.mul=function(t,n){return e.fromValue_noAlloc(t).mul(n)},e.multiply=function(t,n){return e.fromValue_noAlloc(t).mul(n)},e.times=function(t,n){return e.fromValue_noAlloc(t).mul(n)},e.div=function(t,n){return e.fromValue_noAlloc(t).div(n)},e.divide=function(t,n){return e.fromValue_noAlloc(t).div(n)},e.recip=function(t){return e.fromValue_noAlloc(t).recip()},e.reciprocal=function(t){return e.fromValue_noAlloc(t).recip()},e.reciprocate=function(t){return e.fromValue_noAlloc(t).reciprocate()},e.cmp=function(t,n){return e.fromValue_noAlloc(t).cmp(n)},e.compare=function(t,n){return e.fromValue_noAlloc(t).cmp(n)},e.eq=function(t,n){return e.fromValue_noAlloc(t).eq(n)},e.equals=function(t,n){return e.fromValue_noAlloc(t).eq(n)},e.neq=function(t,n){return e.fromValue_noAlloc(t).neq(n)},e.notEquals=function(t,n){return e.fromValue_noAlloc(t).notEquals(n)},e.lt=function(t,n){return e.fromValue_noAlloc(t).lt(n)},e.lte=function(t,n){return e.fromValue_noAlloc(t).lte(n)},e.gt=function(t,n){return e.fromValue_noAlloc(t).gt(n)},e.gte=function(t,n){return e.fromValue_noAlloc(t).gte(n)},e.max=function(t,n){return e.fromValue_noAlloc(t).max(n)},e.min=function(t,n){return e.fromValue_noAlloc(t).min(n)},e.cmp_tolerance=function(t,n,o){return e.fromValue_noAlloc(t).cmp_tolerance(n,o)},e.compare_tolerance=function(t,n,o){return e.fromValue_noAlloc(t).cmp_tolerance(n,o)},e.eq_tolerance=function(t,n,o){return e.fromValue_noAlloc(t).eq_tolerance(n,o)},e.equals_tolerance=function(t,n,o){return e.fromValue_noAlloc(t).eq_tolerance(n,o)},e.neq_tolerance=function(t,n,o){return e.fromValue_noAlloc(t).neq_tolerance(n,o)},e.notEquals_tolerance=function(t,n,o){return e.fromValue_noAlloc(t).notEquals_tolerance(n,o)},e.lt_tolerance=function(t,n,o){return e.fromValue_noAlloc(t).lt_tolerance(n,o)},e.lte_tolerance=function(t,n,o){return e.fromValue_noAlloc(t).lte_tolerance(n,o)},e.gt_tolerance=function(t,n,o){return e.fromValue_noAlloc(t).gt_tolerance(n,o)},e.gte_tolerance=function(t,n,o){return e.fromValue_noAlloc(t).gte_tolerance(n,o)},e.log10=function(t){return e.fromValue_noAlloc(t).log10()},e.log=function(t,n){return e.fromValue_noAlloc(t).log(n)},e.log2=function(t){return e.fromValue_noAlloc(t).log2()},e.ln=function(t){return e.fromValue_noAlloc(t).ln()},e.logarithm=function(t,n){return e.fromValue_noAlloc(t).logarithm(n)},e.pow10=function(t){return Number.isInteger(t)?e.fromMantissaExponent_noNormalize(1,t):e.fromMantissaExponent(Math.pow(10,t%1),Math.trunc(t))},e.pow=function(t,n){return"number"==typeof t&&10===t&&"number"==typeof n&&Number.isInteger(n)?e.fromMantissaExponent_noNormalize(1,n):e.fromValue_noAlloc(t).pow(n)},e.exp=function(t){return e.fromValue_noAlloc(t).exp()},e.sqr=function(t){return e.fromValue_noAlloc(t).sqr()},e.sqrt=function(t){return e.fromValue_noAlloc(t).sqrt()},e.cube=function(t){return e.fromValue_noAlloc(t).cube()},e.cbrt=function(t){return e.fromValue_noAlloc(t).cbrt()},e.affordGeometricSeries=function(t,n,o,r){return this.affordGeometricSeries_core(e.fromValue_noAlloc(t),e.fromValue_noAlloc(n),e.fromValue_noAlloc(o),r)},e.sumGeometricSeries=function(t,n,o,r){return this.sumGeometricSeries_core(t,e.fromValue_noAlloc(n),e.fromValue_noAlloc(o),r)},e.affordArithmeticSeries=function(t,n,o,r){return this.affordArithmeticSeries_core(e.fromValue_noAlloc(t),e.fromValue_noAlloc(n),e.fromValue_noAlloc(o),e.fromValue_noAlloc(r))},e.sumArithmeticSeries=function(t,n,o,r){return this.sumArithmeticSeries_core(e.fromValue_noAlloc(t),e.fromValue_noAlloc(n),e.fromValue_noAlloc(o),e.fromValue_noAlloc(r))},e.efficiencyOfPurchase=function(t,n,o){return this.efficiencyOfPurchase_core(e.fromValue_noAlloc(t),e.fromValue_noAlloc(n),e.fromValue_noAlloc(o))},e.randomDecimalForTesting=function(t){if(20*Math.random()<1)return e.fromMantissaExponent_noNormalize(0,0);var n=10*Math.random();10*Math.random()<1&&(n=Math.round(n)),n*=Math.sign(2*Math.random()-1);var o=Math.floor(Math.random()*t*2)-t;return e.fromMantissaExponent(n,o)},e.affordGeometricSeries_core=function(t,n,o,r){var i=n.mul(o.pow(r));return e.floor(t.div(i).mul(o.sub(1)).add(1).log10()/o.log10())},e.sumGeometricSeries_core=function(t,n,o,r){return n.mul(o.pow(r)).mul(e.sub(1,o.pow(t))).div(e.sub(1,o))},e.affordArithmeticSeries_core=function(t,n,e,o){var r=n.add(o.mul(e)).sub(e.div(2)),i=r.pow(2);return r.neg().add(i.add(e.mul(t).mul(2)).sqrt()).div(e).floor()},e.sumArithmeticSeries_core=function(t,n,e,o){var r=n.add(o.mul(e));return t.div(2).mul(r.mul(2).plus(t.sub(1).mul(e)))},e.efficiencyOfPurchase_core=function(t,n,e){return t.div(n).add(t.div(e))},e.prototype.normalize=function(){if(!(this.mantissa>=1&&this.mantissa<10)){if(0===this.mantissa)return this.mantissa=0,void(this.exponent=0);var t=Math.floor(Math.log10(Math.abs(this.mantissa)));return this.mantissa=this.mantissa/n(t),this.exponent+=t,this}},e.prototype.fromMantissaExponent=function(t,n){return isFinite(t)&&isFinite(n)?(this.mantissa=t,this.exponent=n,this.normalize(),this):(t=Number.NaN,n=Number.NaN,this)},e.prototype.fromMantissaExponent_noNormalize=function(t,n){return this.mantissa=t,this.exponent=n,this},e.prototype.fromDecimal=function(t){return this.mantissa=t.mantissa,this.exponent=t.exponent,this},e.prototype.fromNumber=function(t){return isNaN(t)?(this.mantissa=Number.NaN,this.exponent=Number.NaN):t===Number.POSITIVE_INFINITY?(this.mantissa=1,this.exponent=9e15):t===Number.NEGATIVE_INFINITY?(this.mantissa=-1,this.exponent=9e15):0===t?(this.mantissa=0,this.exponent=0):(this.exponent=Math.floor(Math.log10(Math.abs(t))),this.mantissa=-324===this.exponent?10*t/1e-323:t/n(this.exponent),this.normalize()),this},e.prototype.fromString=function(t){if(-1!==t.indexOf("e")){var n=t.split("e");this.mantissa=parseFloat(n[0]),this.exponent=parseFloat(n[1]),this.normalize()}else if("NaN"===t)this.mantissa=Number.NaN,this.exponent=Number.NaN;else if(this.fromNumber(parseFloat(t)),isNaN(this.mantissa))throw Error("[DecimalError] Invalid argument: "+t);return this},e.prototype.fromValue=function(t){return t instanceof e?this.fromDecimal(t):"number"==typeof t?this.fromNumber(t):"string"==typeof t?this.fromString(t):(this.mantissa=0,this.exponent=0,this)},e.prototype.toNumber=function(){if(!isFinite(this.exponent))return Number.NaN;if(this.exponent>308)return this.mantissa>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;if(this.exponent<-324)return 0;if(-324===this.exponent)return this.mantissa>0?5e-324:-5e-324;var t=this.mantissa*n(this.exponent);if(!isFinite(t)||this.exponent<0)return t;var e=Math.round(t);return Math.abs(e-t)<1e-10?e:t},e.prototype.mantissaWithDecimalPlaces=function(t){if(isNaN(this.mantissa)||isNaN(this.exponent))return Number.NaN;if(0===this.mantissa)return 0;var n=t+1,e=Math.ceil(Math.log10(Math.abs(this.mantissa))),o=Math.round(this.mantissa*Math.pow(10,n-e))*Math.pow(10,e-n);return parseFloat(o.toFixed(Math.max(n-e,0)))},e.prototype.toString=function(){return isNaN(this.mantissa)||isNaN(this.exponent)?"NaN":this.exponent>=9e15?this.mantissa>0?"Infinity":"-Infinity":this.exponent<=-9e15||0===this.mantissa?"0":this.exponent<21&&this.exponent>-7?this.toNumber().toString():this.mantissa+"e"+(this.exponent>=0?"+":"")+this.exponent},e.prototype.toExponential=function(n){if(isNaN(this.mantissa)||isNaN(this.exponent))return"NaN";if(this.exponent>=9e15)return this.mantissa>0?"Infinity":"-Infinity";if(this.exponent<=-9e15||0===this.mantissa)return"0"+(n>0?t(".",n+1,"0"):"")+"e+0";if(this.exponent>-324&&this.exponent<308)return this.toNumber().toExponential(n);isFinite(n)||(n=17);var e=n+1,o=Math.max(1,Math.ceil(Math.log10(Math.abs(this.mantissa))));return(Math.round(this.mantissa*Math.pow(10,e-o))*Math.pow(10,o-e)).toFixed(Math.max(e-o,0))+"e"+(this.exponent>=0?"+":"")+this.exponent},e.prototype.toFixed=function(n){return isNaN(this.mantissa)||isNaN(this.exponent)?"NaN":this.exponent>=9e15?this.mantissa>0?"Infinity":"-Infinity":this.exponent<=-9e15||0===this.mantissa?"0"+(n>0?t(".",n+1,"0"):""):this.exponent>=17?this.mantissa.toString().replace(".","").padEnd(this.exponent+1,"0")+(n>0?t(".",n+1,"0"):""):this.toNumber().toFixed(n+1)},e.prototype.toPrecision=function(t){return this.exponent<=-7?this.toExponential(t-1):t>this.exponent?this.toFixed(t-this.exponent-1):this.toExponential(t-1)},e.prototype.valueOf=function(){return this.toString()},e.prototype.toJSON=function(){return this.toString()},e.prototype.toStringWithDecimalPlaces=function(t){return this.toExponential(t)},e.prototype.abs=function(){return e.fromMantissaExponent_noNormalize(Math.abs(this.mantissa),this.exponent)},e.prototype.neg=function(){return e.fromMantissaExponent_noNormalize(-this.mantissa,this.exponent)},e.prototype.negate=function(){return this.neg()},e.prototype.negated=function(){return this.neg()},e.prototype.sign=function(){return Math.sign(this.mantissa)},e.prototype.sgn=function(){return this.sign()},e.prototype.round=function(){return this.exponent<-1?new e(0):this.exponent<17?new e(Math.round(this.toNumber())):this},e.prototype.floor=function(){return this.exponent<-1?Math.sign(this.mantissa)>=0?new e(0):new e(-1):this.exponent<17?new e(Math.floor(this.toNumber())):this},e.prototype.ceil=function(){return this.exponent<-1?Math.sign(this.mantissa)>0?new e(1):new e(0):this.exponent<17?new e(Math.ceil(this.toNumber())):this},e.prototype.trunc=function(){return this.exponent<0?new e(0):this.exponent<17?new e(Math.trunc(this.toNumber())):this},e.prototype.add=function(t){var o,r,i=e.fromValue_noAlloc(t);return 0===this.mantissa?i:0===i.mantissa?this:(this.exponent>=i.exponent?(o=this,r=i):(o=i,r=this),o.exponent-r.exponent>17?o:e.fromMantissaExponent(Math.round(1e14*o.mantissa+1e14*r.mantissa*n(r.exponent-o.exponent)),o.exponent-14))},e.prototype.plus=function(t){return this.add(t)},e.prototype.sub=function(t){return this.add(e.fromValue_noAlloc(t).neg())},e.prototype.subtract=function(t){return this.sub(t)},e.prototype.minus=function(t){return this.sub(t)},e.prototype.mul=function(t){var n=e.fromValue_noAlloc(t);return e.fromMantissaExponent(this.mantissa*n.mantissa,this.exponent+n.exponent)},e.prototype.multiply=function(t){return this.mul(t)},e.prototype.times=function(t){return this.mul(t)},e.prototype.div=function(t){return this.mul(e.fromValue_noAlloc(t).recip())},e.prototype.divide=function(t){return this.div(t)},e.prototype.divideBy=function(t){return this.div(t)},e.prototype.dividedBy=function(t){return this.div(t)},e.prototype.recip=function(){return e.fromMantissaExponent(1/this.mantissa,-this.exponent)},e.prototype.reciprocal=function(){return this.recip()},e.prototype.reciprocate=function(){return this.recip()},e.prototype.cmp=function(t){var n=e.fromValue_noAlloc(t);if(0===this.mantissa){if(0===n.mantissa)return 0;if(n.mantissa<0)return 1;if(n.mantissa>0)return-1}if(0===n.mantissa){if(this.mantissa<0)return-1;if(this.mantissa>0)return 1}if(this.mantissa>0)return n.mantissa<0?1:this.exponent>n.exponent?1:this.exponent<n.exponent?-1:this.mantissa>n.mantissa?1:this.mantissa<n.mantissa?-1:0;if(this.mantissa<0)return n.mantissa>0?-1:this.exponent>n.exponent?-1:this.exponent<n.exponent?1:this.mantissa>n.mantissa?1:this.mantissa<n.mantissa?-1:0;throw Error("Unreachable code")},e.prototype.compare=function(t){return this.cmp(t)},e.prototype.eq=function(t){var n=e.fromValue_noAlloc(t);return this.exponent===n.exponent&&this.mantissa===n.mantissa},e.prototype.equals=function(t){return this.eq(t)},e.prototype.neq=function(t){return!this.eq(t)},e.prototype.notEquals=function(t){return this.neq(t)},e.prototype.lt=function(t){var n=e.fromValue_noAlloc(t);return 0===this.mantissa?n.mantissa>0:0===n.mantissa?this.mantissa<=0:this.exponent===n.exponent?this.mantissa<n.mantissa:this.mantissa>0?n.mantissa>0&&this.exponent<n.exponent:n.mantissa>0||this.exponent>n.exponent},e.prototype.lte=function(t){return!this.gt(t)},e.prototype.gt=function(t){var n=e.fromValue_noAlloc(t);return 0===this.mantissa?n.mantissa<0:0===n.mantissa?this.mantissa>0:this.exponent===n.exponent?this.mantissa>n.mantissa:this.mantissa>0?n.mantissa<0||this.exponent>n.exponent:n.mantissa<0&&this.exponent<n.exponent},e.prototype.gte=function(t){return!this.lt(t)},e.prototype.max=function(t){var n=e.fromValue_noAlloc(t);return this.lt(n)?n:this},e.prototype.min=function(t){var n=e.fromValue_noAlloc(t);return this.gt(n)?n:this},e.prototype.cmp_tolerance=function(t,n){var o=e.fromValue_noAlloc(t);return this.eq_tolerance(o,n)?0:this.cmp(o)},e.prototype.compare_tolerance=function(t,n){return this.cmp_tolerance(t,n)},e.prototype.eq_tolerance=function(t,n){var o=e.fromValue_noAlloc(t);return e.lte(this.sub(o).abs(),e.max(this.abs(),o.abs()).mul(n))},e.prototype.equals_tolerance=function(t,n){return this.eq_tolerance(t,n)},e.prototype.neq_tolerance=function(t,n){return!this.eq_tolerance(t,n)},e.prototype.notEquals_tolerance=function(t,n){return this.neq_tolerance(t,n)},e.prototype.lt_tolerance=function(t,n){var o=e.fromValue_noAlloc(t);return!this.eq_tolerance(o,n)&&this.lt(o)},e.prototype.lte_tolerance=function(t,n){var o=e.fromValue_noAlloc(t);return this.eq_tolerance(o,n)||this.lt(o)},e.prototype.gt_tolerance=function(t,n){var o=e.fromValue_noAlloc(t);return!this.eq_tolerance(o,n)&&this.gt(o)},e.prototype.gte_tolerance=function(t,n){var o=e.fromValue_noAlloc(t);return this.eq_tolerance(o,n)||this.gt(o)},e.prototype.abslog10=function(){return this.exponent+Math.log10(Math.abs(this.mantissa))},e.prototype.log10=function(){return this.exponent+Math.log10(this.mantissa)},e.prototype.log=function(t){return Math.LN10/Math.log(t)*this.log10()},e.prototype.log2=function(){return 3.321928094887362*this.log10()},e.prototype.ln=function(){return 2.302585092994046*this.log10()},e.prototype.logarithm=function(t){return this.log(t)},e.prototype.pow=function(t){var n,o=t instanceof e?t.toNumber():t,r=this.exponent*o;if(Number.isSafeInteger(r)&&(n=Math.pow(this.mantissa,o),isFinite(n)))return e.fromMantissaExponent(n,r);var i=Math.trunc(r),s=r-i;if(n=Math.pow(10,o*Math.log10(this.mantissa)+s),isFinite(n))return e.fromMantissaExponent(n,i);var a=e.pow10(o*this.abslog10());return-1===this.sign()&&o%2==1?a.neg():a},e.prototype.pow_base=function(t){return e.fromValue_noAlloc(t).pow(this)},e.prototype.factorial=function(){var t=this.toNumber()+1;return e.pow(t/Math.E*Math.sqrt(t*Math.sinh(1/t)+1/(810*Math.pow(t,6))),t).mul(Math.sqrt(2*Math.PI/t))},e.prototype.exp=function(){var t,n,o=this.toNumber();return-706<o&&o<709?e.fromNumber(Math.exp(o)):(t=0,(n=this.exponent)>=0&&(o-=(t=Math.trunc(o/Math.LN10))*Math.LN10)>=Math.LN10&&(++t,o-=Math.LN10),o<0&&(--t,o+=Math.LN10),o=Math.exp(o),0!==t&&(n=Math.floor(t),e.fromMantissaExponent(o,n)),e.fromNumber(o))},e.prototype.sqr=function(){return e.fromMantissaExponent(Math.pow(this.mantissa,2),2*this.exponent)},e.prototype.sqrt=function(){return this.mantissa<0?new e(Number.NaN):this.exponent%2!=0?e.fromMantissaExponent(3.16227766016838*Math.sqrt(this.mantissa),Math.floor(this.exponent/2)):e.fromMantissaExponent(Math.sqrt(this.mantissa),Math.floor(this.exponent/2))},e.prototype.cube=function(){return e.fromMantissaExponent(Math.pow(this.mantissa,3),3*this.exponent)},e.prototype.cbrt=function(){var t=1,n=this.mantissa;n<0&&(t=-1,n=-n);var o=t*Math.pow(n,1/3),r=this.exponent%3;return 1===r||-1===r?e.fromMantissaExponent(2.154434690031884*o,Math.floor(this.exponent/3)):0!==r?e.fromMantissaExponent(4.641588833612779*o,Math.floor(this.exponent/3)):e.fromMantissaExponent(o,Math.floor(this.exponent/3))},e.prototype.sinh=function(){return this.exp().sub(this.negate().exp()).div(2)},e.prototype.cosh=function(){return this.exp().add(this.negate().exp()).div(2)},e.prototype.tanh=function(){return this.sinh().div(this.cosh())},e.prototype.asinh=function(){return e.ln(this.add(this.sqr().add(1).sqrt()))},e.prototype.acosh=function(){return e.ln(this.add(this.sqr().sub(1).sqrt()))},e.prototype.atanh=function(){return this.abs().gte(1)?Number.NaN:e.ln(this.add(1).div(new e(1).sub(this)))/2},e.prototype.ascensionPenalty=function(t){return 0===t?this:this.pow(Math.pow(10,-t))},e.prototype.egg=function(){return this.add(9)},e.prototype.lessThanOrEqualTo=function(t){return this.cmp(t)<1},e.prototype.lessThan=function(t){return this.cmp(t)<0},e.prototype.greaterThanOrEqualTo=function(t){return this.cmp(t)>-1},e.prototype.greaterThan=function(t){return this.cmp(t)>0},e}()});
